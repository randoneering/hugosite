<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<meta property="og:url" content="/blog/databases/mariadbplaybook/">
  <meta property="og:title" content="Basic MariaDB Install Playbook">
  <meta property="og:description" content="When you just want a simple install of MariaDB via Ansible">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2022-01-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2022-01-01T00:00:00+00:00">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Basic MariaDB Install Playbook">
  <meta name="twitter:description" content="When you just want a simple install of MariaDB via Ansible">

<title>Basic MariaDB Install Playbook | </title>
<meta name="keywords" content="" />
<meta name="description" content="When you just want a simple install of MariaDB via Ansible">
<meta name="author" content="Justin@Randoneering">
<link rel="canonical" href="/blog/databases/mariadbplaybook/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.62d7562978a37edf25a23b592a9bff9e34f66e80efcc9cf2fd267942b990cf7a.css" integrity="sha256-YtdWKXijft8lojtZKpv/njT2boDvzJzy/SZ5QrmQz3o=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.2eadbb982468c11a433a3e291f01326f2ba43f065e256bf792dbd79640a92316.js" integrity="sha256-Lq27mCRowRpDOj4pHwEybyukPwZeJWv3ktvXlkCpIxY="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="/images/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="mask-icon" href="/images/apple-touch-icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/blog/databases/mariadbplaybook/" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
        <span class="logo-switches">
            <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
                <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
        <ul id="menu">
            <li>
                <a href="/" title="Home"><span>Home</span></a>
            </li>
            <li>
                <a href="/services/" title="Hire Me">
                    <span>Hire Me</span>
                </a>
            </li>
            <li>
                <a href="/blog/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="/contact/" title="Contact">
                    <span>Contact</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/blog/">Blog</a></div>
    <h1 class="post-title">
      Basic MariaDB Install Playbook
    </h1>
    <div class="post-description">
      When you just want a simple install of MariaDB via Ansible
    </div>
    <div class="post-meta">January 1, 2022 - 2 min - Justin@Randoneering</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#getting-down-to-the-basics" aria-label="Getting Down to the Basics">Getting Down to the Basics</a><ul>
                        
                <li>
                    <a href="#before-you-copy-pasta" aria-label="Before You Copy Pasta">Before You Copy Pasta</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content">
  <h1 id="getting-down-to-the-basics">Getting Down to the Basics</h1>
<p>This will be an ongoing task and is in a private repo currently. However, I wanted to share the core of the playbook here. Check back periodically where I will make adjustments to include other best practices. Once I feel like this is in a solid state, I will open up the github repo for easy of use.</p>
<h2 id="before-you-copy-pasta">Before You Copy Pasta</h2>
<p>Notice the variables-you will need to add your own vars file, inventory file, and your ansible.cfg file. This is not complete, but works in its current state. Feel free to use at your own discretion.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">hosts</span>: <span style="color:#ae81ff">all</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">become</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">vars_files</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">external vars file location </span> <span style="color:#75715e">#add your own var location</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">tasks</span>:
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">update repository index</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">apt</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">update_cache</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">install mariadb and related plugins</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">apt</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">mariadb-server</span>
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">create /data/database directory and mount</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">file</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/data/database</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">state</span>: <span style="color:#ae81ff">directory</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">owner</span>: <span style="color:#ae81ff">mysql</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Adds Python3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">apt</span>: <span style="color:#ae81ff">pkg=&#34;python3&#34; state=present</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">when</span>: <span style="color:#ae81ff">ansible_os_family ==&#39;Debian&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Adds Python2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">apt</span>: <span style="color:#ae81ff">pkg=&#34;python2&#34; state=present</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">when</span>: <span style="color:#ae81ff">ansible_os_family ==&#39;Debian&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Install Python3-mysqldb</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">apt</span>: <span style="color:#ae81ff">pkg=&#34;python3-mysqldb&#34; state=present</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">when</span>: <span style="color:#ae81ff">ansible_os_family ==&#39;Debian&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Change root user password on first run</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#34;{{ mysql_root_password }}&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">name=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">password={{ mysql_root_password }}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">priv=*.*:ALL,GRANT</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;localhost&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">delete anonymous MySQL server user</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#39;{{ mysql_root_password }}&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">user=&#34;&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;localhost&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">state=&#34;absent&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">remove the MySQL test database</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">action</span>: <span style="color:#ae81ff">mysql_db login_user=root login_password=&#34;{{ mysql_root_password }}&#34; db=test state=absent</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Secures the MySQL root user for IPV6 localhost (::1)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#39;{{ mysql_root_password }}&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;::1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">no_log</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Secures the MySQL root user for IPV4 localhost (127.0.0.1)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#39;{{ mysql_root_password }}&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;127.0.0.1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">no_log</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Secures the MySQL root user for localhost domain (localhost)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#39;{{ mysql_root_password }}&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;localhost&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">no_log</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Secures the MySQL root user for server_hostname domain</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#39;{{ mysql_root_password }}&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;{{ server_fqdn }}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">no_log</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Create /var/log/mariadb directory</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">file</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/log/mariadb</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">state</span>: <span style="color:#ae81ff">directory</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">owner</span>: <span style="color:#ae81ff">mysql</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Stop mariadb service</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ansible.builtin.service</span>: 
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">state</span>: <span style="color:#ae81ff">stopped</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Copy var/lib/mysql to /data/database</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ansible.builtin.copy</span>: 
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">remote_src</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">src</span>: <span style="color:#ae81ff">/var/lib/mysql/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">dest</span>: <span style="color:#ae81ff">/data/database/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">owner</span>: <span style="color:#ae81ff">mysql</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">group</span>: <span style="color:#ae81ff">mysql</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Copy preconfigured config file for mariadb</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ansible.builtin.copy</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">src</span>: <span style="color:#ae81ff">location for template conf file</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">dest</span>: <span style="color:#ae81ff">/etc/mysql/mariadb.conf.d</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">owner</span>: <span style="color:#ae81ff">root</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">group</span>: <span style="color:#ae81ff">root</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Start mariadb service</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ansible.builtin.service</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">state</span>: <span style="color:#ae81ff">started</span>
</span></span></code></pre></div>
  </div>

  <footer class="post-footer">

<div class="share-buttons">

    <a target="_blank" rel="noopener noreferrer" aria-label="share Basic MariaDB Install Playbook on linkedin"
        href="https://www.linkedin.com/in/justin-frye-b4b14763/">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
</div>

  </footer>
  <script src="https://giscus.app/client.js"
  data-repo="randoneering/hugosite"
  data-repo-id="R_kgDOJ7Rs5w"
  data-category="Announcements"
  data-category-id="DIC_kwDOJ7Rs584Ck7Xe"
  data-mapping="pathname"
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="bottom"
  data-theme="transparent_dark"
  data-lang="en"
  crossorigin="anonymous"
  async>
</script>
</article>
    </main>
    
<footer class="footer">
    <span> Copyright© Randoneering, LLC 2025
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
