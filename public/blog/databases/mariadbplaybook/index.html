<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="When you just want a simple install of MariaDB via Ansible" />
<meta name="keywords" content="open-source, nixos, nix, linux, python, engineering" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/blog/databases/mariadbplaybook/" />


    <title>
        
            Basic MariaDB Install Playbook ::  
        
    </title>





  <link rel="stylesheet" href="/main.min.ecc6ec8f243acbd278a9df5ba1abeb98c3aa3b39f8f19074fb486b4583e8f517.css" integrity="sha256-7MbsjyQ6y9J4qd9boavrmMOqOzn48ZB0&#43;0hrRYPo9Rc=" crossorigin="anonymous">





    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Basic MariaDB Install Playbook">
  <meta itemprop="description" content="When you just want a simple install of MariaDB via Ansible">
  <meta itemprop="datePublished" content="2022-01-01T00:00:00+00:00">
  <meta itemprop="dateModified" content="2022-01-01T00:00:00+00:00">
  <meta itemprop="wordCount" content="388">
  <meta itemprop="image" content="/images/randoneering_logo_only.jpg">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="/images/randoneering_logo_only.jpg">
  <meta name="twitter:title" content="Basic MariaDB Install Playbook">
  <meta name="twitter:description" content="When you just want a simple install of MariaDB via Ansible">







    <meta property="article:published_time" content="2022-01-01 00:00:00 &#43;0000 UTC" />












    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text logo__pathname">
                $ cd ~/</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#fabd2f;
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">about</a></li><li><a href="/blog/">blog</a></li><li><a href="/services/">services</a></li>
        <ul class="submenu">
            <li class="dropdown">
                <a href="javascript:void(0)" class="dropbtn">en</a>
                <div class="dropdown-content">
                        
                </div>
            </li>
        </ul>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="/blog/databases/mariadbplaybook/">Basic MariaDB Install Playbook</a></h2>

            
            
            

            <div class="post-content">
                <h1 id="getting-down-to-the-basics">Getting Down to the Basics</h1>
<p>This will be an ongoing task and is in a private repo currently. However, I wanted to share the core of the playbook here. Check back periodically where I will make adjustments to include other best practices. Once I feel like this is in a solid state, I will open up the github repo for easy of use.</p>
<h2 id="before-you-copy-pasta">Before You Copy Pasta</h2>
<p>Notice the variables-you will need to add your own vars file, inventory file, and your ansible.cfg file. This is not complete, but works in its current state. Feel free to use at your own discretion.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#f92672">hosts</span>: <span style="color:#ae81ff">all</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">become</span>: <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">vars_files</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">external vars file location </span> <span style="color:#75715e">#add your own var location</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">tasks</span>:
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">update repository index</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">apt</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">update_cache</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">install mariadb and related plugins</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">apt</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">mariadb-server</span>
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">create /data/database directory and mount</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">file</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/data/database</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">state</span>: <span style="color:#ae81ff">directory</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">owner</span>: <span style="color:#ae81ff">mysql</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Adds Python3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">apt</span>: <span style="color:#ae81ff">pkg=&#34;python3&#34; state=present</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">when</span>: <span style="color:#ae81ff">ansible_os_family ==&#39;Debian&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Adds Python2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">apt</span>: <span style="color:#ae81ff">pkg=&#34;python2&#34; state=present</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">when</span>: <span style="color:#ae81ff">ansible_os_family ==&#39;Debian&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Install Python3-mysqldb</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">apt</span>: <span style="color:#ae81ff">pkg=&#34;python3-mysqldb&#34; state=present</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">when</span>: <span style="color:#ae81ff">ansible_os_family ==&#39;Debian&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Change root user password on first run</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#34;{{ mysql_root_password }}&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">name=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">password={{ mysql_root_password }}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">priv=*.*:ALL,GRANT</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;localhost&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">delete anonymous MySQL server user</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#39;{{ mysql_root_password }}&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">user=&#34;&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;localhost&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">state=&#34;absent&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">remove the MySQL test database</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">action</span>: <span style="color:#ae81ff">mysql_db login_user=root login_password=&#34;{{ mysql_root_password }}&#34; db=test state=absent</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Secures the MySQL root user for IPV6 localhost (::1)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#39;{{ mysql_root_password }}&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;::1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">no_log</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Secures the MySQL root user for IPV4 localhost (127.0.0.1)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#39;{{ mysql_root_password }}&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;127.0.0.1&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">no_log</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Secures the MySQL root user for localhost domain (localhost)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#39;{{ mysql_root_password }}&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;localhost&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">no_log</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Secures the MySQL root user for server_hostname domain</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">mysql_user</span>: <span style="color:#ae81ff">login_user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">login_password=&#39;{{ mysql_root_password }}&#39;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">check_implicit_admin=yes</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">user=root</span>
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">host=&#34;{{ server_fqdn }}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">no_log</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Create /var/log/mariadb directory</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">file</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">path</span>: <span style="color:#ae81ff">/var/log/mariadb</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">state</span>: <span style="color:#ae81ff">directory</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">owner</span>: <span style="color:#ae81ff">mysql</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Stop mariadb service</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ansible.builtin.service</span>: 
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">state</span>: <span style="color:#ae81ff">stopped</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Copy var/lib/mysql to /data/database</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ansible.builtin.copy</span>: 
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">remote_src</span>: <span style="color:#66d9ef">yes</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">src</span>: <span style="color:#ae81ff">/var/lib/mysql/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">dest</span>: <span style="color:#ae81ff">/data/database/</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">owner</span>: <span style="color:#ae81ff">mysql</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">group</span>: <span style="color:#ae81ff">mysql</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Copy preconfigured config file for mariadb</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ansible.builtin.copy</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">src</span>: <span style="color:#ae81ff">location for template conf file</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">dest</span>: <span style="color:#ae81ff">/etc/mysql/mariadb.conf.d</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">owner</span>: <span style="color:#ae81ff">root</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">group</span>: <span style="color:#ae81ff">root</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Start mariadb service</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ansible.builtin.service</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">name</span>: <span style="color:#ae81ff">mariadb</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">state</span>: <span style="color:#ae81ff">started</span>
</span></span></code></pre></div>
            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2025</span>
            <span><a href="/">Justin Frye (Randoneering)</a></span>
            <span></span>
            <span><a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            <span></span>
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Made with &#9749 and random engineering</span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js" integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc&#43;cxaJzDdCYbAW0X1G&#43;DgZYvtKFXe6MBex8jUJ2JT25mQx&#43;YjACIng=="></script>




    </body>
</html>
